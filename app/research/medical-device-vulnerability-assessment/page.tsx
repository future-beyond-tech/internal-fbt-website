import Link from "next/link";
import type { Metadata } from "next";
import Container from "@/components/layout/Container";
import PageViewEvent from "@/components/analytics/PageViewEvent";
import { defaultMetadata } from "@/lib/seo";
import { ResearchDownloadModalTrigger } from "@/components/lead-magnets/ResearchDownloadModal";
import ResearchArticleAnalytics from "./ResearchArticleAnalytics";

const articleTitle = "Medical Device Vulnerability Assessment | FBT Research";
const articleDescription =
  "Comprehensive technical analysis of vulnerability assessment methodologies for medical devices, including passive scanning, firmware analysis, penetration testing, and healthcare-focused CVSS scoring.";
const baseMetadata = defaultMetadata(
  articleTitle,
  articleDescription,
  "/research/medical-device-vulnerability-assessment"
);

export const metadata: Metadata = {
  ...baseMetadata,
  keywords: [
    "medical device cybersecurity",
    "vulnerability assessment",
    "FDA compliance",
    "MITRE CVSS",
    "healthcare security",
  ],
  authors: [{ name: "FBT Security Engineering Team" }],
  openGraph: {
    ...baseMetadata.openGraph,
    title: "Technical Details of Vulnerability Assessments for Medical Products",
    description:
      "FBT Research: Technical analysis of medical device security assessment methodologies.",
    type: "article",
    publishedTime: "2025-02-22",
    images: [
      {
        url: "/research/medical-device/og-card.svg",
        width: 1200,
        height: 630,
        alt: "FBT Research medical device vulnerability assessment",
      },
    ],
  },
  twitter: {
    ...baseMetadata.twitter,
    title: "Technical Details of Vulnerability Assessments for Medical Products",
    description:
      "FBT Research: Technical analysis of medical device security assessment methodologies.",
    images: ["/research/medical-device/og-card.svg"],
  },
};

const articleSchema = {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  headline: "Technical Details of Vulnerability Assessments for Medical Products",
  author: {
    "@type": "Organization",
    name: "FBT Security Engineering Team",
  },
  publisher: {
    "@type": "Organization",
    name: "Future Beyond Technology",
    logo: {
      "@type": "ImageObject",
      url: "https://futurebeyondtech.com/logo.png",
    },
  },
  datePublished: "2025-02-22",
  dateModified: "2025-02-22",
  articleSection: "Medical Device Security",
  keywords:
    "medical device cybersecurity, vulnerability assessment, FDA compliance, MITRE CVSS",
  description: articleDescription,
  url: "https://futurebeyondtech.com/research/medical-device-vulnerability-assessment",
};

export default function ResearchArticlePage() {
  return (
    <main className="min-h-screen bg-white dark:bg-slate-950">
      <PageViewEvent
        pagePath="/research/medical-device-vulnerability-assessment"
        pageTitle="Medical Device Vulnerability Assessment Research"
      />
      <ResearchArticleAnalytics />

      <header className="bg-slate-900 py-16 text-white sm:py-20">
        <Container>
          <div className="mx-auto max-w-4xl">
            <div className="mb-6 flex flex-wrap items-center gap-2">
              <span className="rounded-full bg-amber-500 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-white">
                FBT Research
              </span>
              <span className="text-sm text-slate-400">February 2025</span>
            </div>

            <h1 className="text-3xl font-semibold leading-tight sm:text-4xl lg:text-5xl">
              Technical Details of Vulnerability Assessments for Medical Products
            </h1>
            <p className="mt-6 text-xl leading-relaxed text-slate-300">
              A comprehensive examination of methodologies, tooling decisions,
              and regulatory context for medical device cybersecurity
              assessments.
            </p>

            <div className="mt-8 flex flex-wrap gap-2">
              {[
                "Medical Device Security",
                "Vulnerability Assessment",
                "FDA Compliance",
                "Penetration Testing",
              ].map((tag) => (
                <span
                  key={tag}
                  className="rounded-full bg-slate-800 px-3 py-1 text-xs text-slate-300"
                >
                  {tag}
                </span>
              ))}
            </div>
          </div>
        </Container>
      </header>

      <section className="border-b border-amber-200 bg-amber-50 py-4 dark:border-amber-700 dark:bg-amber-900/20">
        <Container>
          <div className="mx-auto flex max-w-4xl flex-col items-center justify-between gap-4 md:flex-row">
            <p className="text-sm font-medium text-amber-900 dark:text-amber-200">
              Download the full research package and medical device security
              checklist.
            </p>
            <ResearchDownloadModalTrigger
              source="research-article-banner"
              researchTitle="Technical Details of Vulnerability Assessments for Medical Products"
              buttonLabel="Download Research Kit"
              className="inline-flex min-h-[40px] items-center justify-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-amber-700"
            />
          </div>
        </Container>
      </section>

      <article className="py-16 sm:py-20">
        <Container>
          <div className="mx-auto max-w-4xl space-y-14 text-slate-700 dark:text-slate-300">
            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Executive Summary
              </h2>
              <div className="rounded-lg border-l-4 border-emerald-500 bg-slate-50 p-6 dark:bg-slate-900">
                <p className="leading-relaxed">
                  Vulnerability assessments for medical products require a
                  different operating model than conventional IT assessments.
                  Patient safety must be evaluated alongside exploitability and
                  business continuity. The most effective programs combine
                  patient safety risk framing, non-disruptive network analysis,
                  firmware-level review, and continuous postmarket monitoring.
                </p>
              </div>
              <div className="grid gap-4 md:grid-cols-3">
                <Metric
                  value="64%"
                  label="vulnerabilities discovered in third-party components"
                />
                <Metric
                  value="3.2 years"
                  label="average purchase-to-disclosure exposure window"
                />
                <Metric
                  value="50%"
                  label="CVSS ranking shifts under healthcare context scoring"
                />
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Foundational Assessment Methodologies
              </h2>
              <h3 className="text-xl font-semibold text-slate-900 dark:text-slate-100">
                Security Risk Assessment Framework
              </h3>
              <p className="leading-relaxed">
                The Security Risk Assessment framework should be lifecycle-wide:
                concept, development, deployment, maintenance, and retirement.
                Teams that embed security decisions only at release time create
                expensive remediation cycles and avoidable clinical risk.
              </p>
              <div className="rounded-lg bg-amber-50 p-6 dark:bg-amber-900/20">
                <h4 className="font-semibold text-amber-900 dark:text-amber-100">
                  SRA process phases
                </h4>
                <ul className="mt-3 space-y-2 text-sm text-amber-800 dark:text-amber-200">
                  <li>- Preparation: scope definition and stakeholder mapping</li>
                  <li>- Discovery: asset and attack surface identification</li>
                  <li>- Vulnerability identification: automated plus manual review</li>
                  <li>- Risk analysis: exploitability and patient impact assessment</li>
                  <li>- Remediation planning: patch strategy and compensating controls</li>
                </ul>
              </div>
              <h3 className="text-xl font-semibold text-slate-900 dark:text-slate-100">
                Integration with ISO 14971
              </h3>
              <p className="leading-relaxed">
                Healthcare security assessment should integrate with ISO 14971
                risk management. Safety risk models random failure. Security
                risk models intelligent adversaries. Effective programs unify
                both into a single governance framework to prevent fragmented
                decision-making.
              </p>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Patient Safety-Centric Risk Prioritization
              </h2>
              <p className="leading-relaxed">
                Traditional severity sorting is not enough. Device function and
                clinical dependency must drive response priorities. A moderate
                technical issue can represent a critical patient safety risk in
                life-sustaining systems.
              </p>
              <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
                <RiskCard
                  title="Life-sustaining"
                  detail="Ventilators, pacemakers, critical infusion systems"
                  response="Immediate response target: 24 hours"
                  tone="red"
                />
                <RiskCard
                  title="Life-supporting"
                  detail="Dialysis and anesthesia systems"
                  response="Response target: 24 to 72 hours"
                  tone="orange"
                />
                <RiskCard
                  title="Diagnostic-critical"
                  detail="Imaging and laboratory analyzers"
                  response="Response target: 72 hours to 1 week"
                  tone="yellow"
                />
                <RiskCard
                  title="Administrative"
                  detail="Scheduling and documentation systems"
                  response="Response target: 1 to 4 weeks"
                  tone="green"
                />
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Network-Based Vulnerability Assessment
              </h2>
              <h3 className="text-xl font-semibold text-slate-900 dark:text-slate-100">
                Passive Scanning Methodologies
              </h3>
              <p className="leading-relaxed">
                Passive assessment is often the safest first approach in
                clinical environments. It captures communication behavior without
                injecting commands that may disrupt care workflows.
              </p>
              <div className="rounded-lg bg-slate-50 p-6 dark:bg-slate-900">
                <h4 className="font-semibold text-slate-900 dark:text-slate-100">
                  Device fingerprinting dimensions
                </h4>
                <ul className="mt-3 space-y-2 text-sm">
                  <li>- Protocol selection and transport patterns</li>
                  <li>- Port usage and service signatures</li>
                  <li>- Communication timing behavior</li>
                  <li>- Payload structure and parser characteristics</li>
                  <li>- Cryptographic configuration signals</li>
                </ul>
              </div>
              <h3 className="text-xl font-semibold text-slate-900 dark:text-slate-100">
                Active Scanning Adaptations
              </h3>
              <p className="leading-relaxed">
                Active testing is still necessary for verification, but scan
                profiles should be conservative. Timeouts and retries must be
                tuned for embedded medical device behavior.
              </p>
              <div className="overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700">
                <table className="w-full min-w-[620px] border-collapse text-left text-sm">
                  <thead>
                    <tr className="bg-slate-100 dark:bg-slate-800">
                      <th className="border border-slate-300 p-3 dark:border-slate-700">
                        Device type
                      </th>
                      <th className="border border-slate-300 p-3 dark:border-slate-700">
                        Timeout guidance
                      </th>
                      <th className="border border-slate-300 p-3 dark:border-slate-700">
                        Typical scan extension
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        Implantable devices
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        30 to 60 seconds
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        10x to 50x
                      </td>
                    </tr>
                    <tr className="bg-slate-50 dark:bg-slate-900/60">
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        Infusion pumps
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        10 to 20 seconds
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        5x to 20x
                      </td>
                    </tr>
                    <tr>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        Patient monitors
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        5 to 10 seconds
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        3x to 10x
                      </td>
                    </tr>
                    <tr className="bg-slate-50 dark:bg-slate-900/60">
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        Imaging systems
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        15 to 30 seconds
                      </td>
                      <td className="border border-slate-300 p-3 dark:border-slate-700">
                        5x to 15x
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Firmware and Software Analysis
              </h2>
              <h3 className="text-xl font-semibold text-slate-900 dark:text-slate-100">
                Static Application Security Testing
              </h3>
              <p className="leading-relaxed">
                Source and binary analysis should evaluate input validation,
                authorization logic, cryptography implementation, and memory
                safety with healthcare-specific use cases.
              </p>
              <div className="grid gap-4 md:grid-cols-2">
                <SignalCard
                  title="Input Validation"
                  description="Clinical format parsing, edge-case handling, and sanitization coverage."
                />
                <SignalCard
                  title="AuthN and AuthZ"
                  description="Access boundaries, emergency workflows, and privilege escalation checks."
                />
                <SignalCard
                  title="Cryptography"
                  description="Algorithm choices, key lifecycle, and secure defaults in constrained hardware."
                />
                <SignalCard
                  title="Memory Safety"
                  description="Buffer handling and fault containment under real-time constraints."
                />
              </div>
              <div className="rounded-lg border-l-4 border-amber-400 bg-amber-50 p-6 dark:bg-amber-900/20">
                <p className="leading-relaxed text-amber-900 dark:text-amber-100">
                  Third-party components remain a dominant risk surface.
                  Composition analysis and SBOM governance should be standard in
                  every release gate.
                </p>
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Penetration Testing and Exploitation Validation
              </h2>
              <p className="leading-relaxed">
                Medical penetration testing should be explicit about safety
                controls, environment isolation, and abort procedures. Tooling is
                only one part of effective validation; operational governance is
                equally important.
              </p>
              <div className="rounded-lg bg-slate-50 p-6 dark:bg-slate-900">
                <h4 className="font-semibold text-slate-900 dark:text-slate-100">
                  Safe testing controls
                </h4>
                <ul className="mt-3 space-y-2 text-sm">
                  <li>- Safety-prioritized payload selection</li>
                  <li>- Strict non-production environment isolation</li>
                  <li>- Real-time monitoring with immediate abort criteria</li>
                  <li>- Clinical engineering coordination and recovery plans</li>
                </ul>
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                MITRE CVSS Healthcare Rubric
              </h2>
              <p className="leading-relaxed">
                The healthcare-extended CVSS model adds context dimensions that
                better represent patient and clinical impact. Teams that use
                healthcare context scoring often reorder remediation priorities
                compared with generic CVSS baselines.
              </p>
              <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                <SignalCard
                  title="Extended Attack Vector"
                  description="Separates interface context such as Bluetooth LE vs classic channels."
                />
                <SignalCard
                  title="Extended Privileges"
                  description="Accounts for healthcare-specific user and operator roles."
                />
                <SignalCard
                  title="Patient Safety Context"
                  description="Flags scenarios requiring deeper clinical safety evaluation."
                />
                <SignalCard
                  title="Extended Scope"
                  description="Distinguishes local subsystem risk from connected care network impact."
                />
                <SignalCard
                  title="Extended Complexity"
                  description="Reflects clinical and operational dependencies affecting exploitability."
                />
                <SignalCard
                  title="Interaction Context"
                  description="Captures patient or clinician action dependencies in exploitation chains."
                />
              </div>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Continuous Monitoring and Lifecycle Integration
              </h2>
              <div className="rounded-lg border-l-4 border-red-400 bg-red-50 p-6 dark:bg-red-900/20">
                <h3 className="font-semibold text-red-900 dark:text-red-100">
                  The 3.2 year exposure window
                </h3>
                <p className="mt-2 leading-relaxed text-red-800 dark:text-red-200">
                  Long disclosure windows make continuous monitoring essential.
                  Effective programs correlate telemetry, vulnerability
                  intelligence, and asset context to reduce exposure during patch
                  cycles.
                </p>
              </div>
              <div className="grid gap-4 md:grid-cols-3">
                <SignalCard
                  title="Anomaly Detection"
                  description="Behavioral baselines and deviation alerts for compromise indicators."
                />
                <SignalCard
                  title="Threat Correlation"
                  description="Automated SBOM and vulnerability intelligence matching."
                />
                <SignalCard
                  title="Response Operations"
                  description="Incident handling linked to clinical and engineering runbooks."
                />
              </div>
              <p className="leading-relaxed">
                DevSecOps integration reduces remediation cost and risk by moving
                controls earlier in design and development cycles.
              </p>
            </section>

            <section className="space-y-6">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                Conclusion
              </h2>
              <p className="leading-relaxed">
                Medical device vulnerability assessment is most effective when it
                combines technical rigor with patient safety prioritization.
                Organizations that integrate passive discovery, targeted
                validation, contextual scoring, and lifecycle monitoring achieve
                stronger compliance and more reliable security outcomes.
              </p>
            </section>

            <section className="space-y-4">
              <h2 className="text-2xl font-semibold text-slate-900 dark:text-slate-100">
                References and Further Reading
              </h2>
              <div className="rounded-lg bg-slate-50 p-6 text-sm dark:bg-slate-900">
                <ul className="space-y-2">
                  <li>[1] MedCity News - Medical device security risk assessments</li>
                  <li>[2] Elite Biomedical Solutions - Device cybersecurity practices</li>
                  <li>[3] Censinet - Medical device vulnerability scoring</li>
                  <li>[4] S3 Connected Health - Cybersecurity in device development</li>
                  <li>[5] Finite State - Medical device vulnerability management</li>
                  <li>[6] FDA - Postmarket cybersecurity management guidance</li>
                  <li>[7] Censinet - Healthcare cybersecurity tooling landscape</li>
                  <li>[8] Intuition Labs - Medical device cybersecurity software</li>
                </ul>
              </div>
            </section>
          </div>
        </Container>
      </article>

      <section className="sticky bottom-0 z-20 border-t border-slate-200 bg-white/95 py-4 backdrop-blur dark:border-slate-700 dark:bg-slate-900/95">
        <Container>
          <div className="mx-auto flex max-w-4xl flex-col items-center justify-between gap-4 md:flex-row">
            <div>
              <p className="font-semibold text-slate-900 dark:text-slate-100">
                Need medical device security expertise?
              </p>
              <p className="text-sm text-slate-600 dark:text-slate-400">
                We implement these frameworks with your engineering and
                compliance teams.
              </p>
            </div>
            <div className="flex flex-wrap gap-3">
              <Link
                href="/contact"
                className="inline-flex min-h-[40px] items-center justify-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-emerald-700"
              >
                Discuss Your Project
              </Link>
              <ResearchDownloadModalTrigger
                source="research-article-sticky-footer"
                researchTitle="Technical Details of Vulnerability Assessments for Medical Products"
                buttonLabel="Download Research Kit"
                className="inline-flex min-h-[40px] items-center justify-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800"
              />
            </div>
          </div>
        </Container>
      </section>

      <section className="bg-slate-900 py-16 text-white">
        <Container>
          <div className="mx-auto max-w-4xl text-center">
            <h2 className="text-3xl font-semibold">Research-Driven Consulting</h2>
            <p className="mx-auto mt-4 max-w-2xl text-slate-300">
              This publication informs our consulting delivery. We help medical
              device manufacturers implement FDA-aligned vulnerability assessment
              programs.
            </p>
            <div className="mt-8 flex flex-col justify-center gap-4 sm:flex-row">
              <Link
                href="/contact"
                className="inline-flex min-h-[44px] items-center justify-center rounded-lg bg-emerald-600 px-8 py-3 text-sm font-semibold text-white transition-colors hover:bg-emerald-700"
              >
                Schedule Consultation
              </Link>
              <Link
                href="/services/security-engineering"
                className="inline-flex min-h-[44px] items-center justify-center rounded-lg border border-slate-600 px-8 py-3 text-sm font-semibold text-white transition-colors hover:bg-slate-800"
              >
                Security Services
              </Link>
            </div>
          </div>
        </Container>
      </section>

      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(articleSchema) }}
      />
    </main>
  );
}

function Metric({ value, label }: { value: string; label: string }) {
  return (
    <article className="rounded-lg border border-slate-200 bg-white p-4 text-center dark:border-slate-700 dark:bg-slate-900">
      <p className="text-3xl font-semibold text-emerald-600 dark:text-emerald-400">
        {value}
      </p>
      <p className="mt-2 text-sm text-slate-600 dark:text-slate-400">{label}</p>
    </article>
  );
}

function SignalCard({
  title,
  description,
}: {
  title: string;
  description: string;
}) {
  return (
    <article className="rounded-lg border border-slate-200 bg-white p-4 dark:border-slate-700 dark:bg-slate-900">
      <h4 className="font-semibold text-slate-900 dark:text-slate-100">{title}</h4>
      <p className="mt-2 text-sm text-slate-600 dark:text-slate-400">
        {description}
      </p>
    </article>
  );
}

function RiskCard({
  title,
  detail,
  response,
  tone,
}: {
  title: string;
  detail: string;
  response: string;
  tone: "red" | "orange" | "yellow" | "green";
}) {
  const colorMap = {
    red: "border-red-200 bg-red-50 text-red-900 dark:border-red-700 dark:bg-red-900/20 dark:text-red-100",
    orange:
      "border-orange-200 bg-orange-50 text-orange-900 dark:border-orange-700 dark:bg-orange-900/20 dark:text-orange-100",
    yellow:
      "border-yellow-200 bg-yellow-50 text-yellow-900 dark:border-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-100",
    green:
      "border-green-200 bg-green-50 text-green-900 dark:border-green-700 dark:bg-green-900/20 dark:text-green-100",
  } as const;

  return (
    <article className={`rounded-lg border p-4 ${colorMap[tone]}`}>
      <h4 className="font-semibold">{title}</h4>
      <p className="mt-2 text-sm">{detail}</p>
      <p className="mt-2 text-xs font-semibold">{response}</p>
    </article>
  );
}
